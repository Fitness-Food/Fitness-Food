<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <title>~ Fitness Food ~ Login</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link href="../styles.css" rel="stylesheet">
    </head>

    <body>
        <header id='nav_bar' class="page-header scrollspy"></header>
        
        <main>

            Account name：<input type="text" name="" id="" value="" /> password：
            <input type="password" name="" id="" value="" />
            <input type="button" name="" id="btn" value="login" />
            <button type="button" id="clear">clean data</button>
        </main>
            
        <footer id="footer"></footer>
            
        <script src="/socket.io/socket.io.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
        <script src="../components/widgets.js"></script>
        <script src="../components/mealPageWidgets.js"></script>
        <script src="./init.js"></script>
    </body>
    <script type="text/javascript">
        var aInputs = document.getElementsByTagName('input');
        var oClear = document.getElementById('clear');
        var db = openDatabase('zuchedenglu', '1.0', 'textdb', '1024*1024');
        db.transaction(function(contex) {
            //  tx.executeSql('drop table userinf');
            //contex.executeSql('create table if not exists userinf(id unique,name,password)');
            contex.executeSql('create table if not exists userinf(id integer primary key AutoIncrement,name,password)');
        });
        var oBtn = document.getElementById('btn');
        var blogin = true;
        oBtn.onclick = function() {
            if (aInputs[0].value && aInputs[1].value) {
                db.transaction(function(contex) {
                    contex.executeSql('select * from userinf', [], function(con, data) {
                        var leg = data.rows.length,
                            i;
                        for (var i = 0; i < leg; i++) {
                            if (aInputs[0].value == data.rows.item(i).name && aInputs[1].value == data.rows.item(i).password) {
                                blogin = false;
                                break;
                            }
                        }
                        if (blogin) {
                            alert('please input corroct account name and password！');
                        } else {
                            alert('login successfully！');
                        }
                    });
                });
            } else {
                alert('please input the account name or password completely！');
            }
        }
        oClear.onclick = function() {
            db.transaction(function(contex) {
                contex.executeSql('drop table userinf');
            });
        }
    </script>

</html>
